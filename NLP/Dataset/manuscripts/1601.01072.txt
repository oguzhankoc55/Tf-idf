constraining the propagation speed of gravitational waves with compact  binaries at cosmological distances in testing gravity a model-independent way, one of crucial tests is measuringthe propagation speed of a gravitational wave (gw). in general relativity, a gwpropagates with the speed of light, while in the alternative theories ofgravity the propagation speed could deviate from the speed of light due to themodification of gravity or spacetime structure at a quantum level. previouslywe proposed the method measuring the gw speed by directly comparing the arrivaltimes between a gw and a photon from the binary merger of neutron stars orneutron star and black hole, assuming that it is associated with a shortgamma-ray burst. the sensitivity is limited by the intrinsic time delay betweena gw and a photon at the source. in this paper, we extend the method todistinguish the intrinsic time delay from the true signal caused by anomalousgw speed with multiple events at cosmological distances, also considering theredshift distribution of gw sources, redshift-dependent gw propagation speed,and the statistics of intrinsic time delays. we show that an advanced gwdetector such as einstein telescope will constrain the gw propagation speed atthe precision of ~10^{-16}. we also discuss the optimal statistic to measurethe gw speed, performing numerical simulations.